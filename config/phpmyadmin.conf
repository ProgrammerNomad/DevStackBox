# phpMyAdmin Virtual Host Configuration

# Create an alias for phpMyAdmin at /phpmyadmin
Alias /phpmyadmin "C:/box/DevStackBox/phpmyadmin"

<Directory "C:/box/DevStackBox/phpmyadmin">
    Options None
    AllowOverride Limit
    Require ip 127.0.0.1
    Require ip ::1
    
    # Handle PHP files through CGI
    AddHandler php-script .php
    Action php-script /php/php-cgi.exe
    
    # Security rules
    <Files "*.php">
        SetHandler php-script
    </Files>
    
    <Files "config.inc.php">
        Require all denied
    </Files>
    
    # Prevent access to version control and other sensitive files
    <Files ~ "^\.">
        Require all denied
    </Files>
    
    <Files ~ "\.(sql|log)$">
        Require all denied
    </Files>
</Directory>

# Deny access to config and tmp directories
<Directory "C:/box/DevStackBox/phpmyadmin/config">
    Require all denied
</Directory>

<Directory "C:/box/DevStackBox/phpmyadmin/tmp">
    Require all denied
</Directory>

# Deny access to libraries and setup
<Directory "C:/box/DevStackBox/phpmyadmin/libraries">
    Require all denied
</Directory>

<Directory "C:/box/DevStackBox/phpmyadmin/setup">
    Require all denied
</Directory>

# Additional security headers for phpMyAdmin
<LocationMatch "^/phpmyadmin">
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</LocationMatch>
